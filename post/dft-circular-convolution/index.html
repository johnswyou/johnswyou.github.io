<!doctype html><!-- This site was created with Wowchemy. https://www.wowchemy.com --><!-- Last Published: March 19, 2023 --><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><script src=/js/mathjax-config.js></script>
<link rel=stylesheet href=/css/vendor-bundle.min.16f785cdb553c8c4431db6775122af35.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin=anonymous media=print onload='this.media="all"'><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js integrity crossorigin=anonymous async></script>
<link rel=stylesheet href=/css/wowchemy.0f229d4b7ebad1917a9a357cba2effab.css><link rel=stylesheet href=/css/libs/chroma/github-light.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=author content="John You"><meta name=description content="In this article, I show the mechanics of the discrete Fourier transform (DFT) and circular convolution (within the context of time series analysis). The goal of this post is to present these two methods in a practical yet non-superficial way."><link rel=alternate hreflang=en-us href=https://johnswyou.github.io/post/dft-circular-convolution/><link rel=canonical href=https://johnswyou.github.io/post/dft-circular-convolution/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#1565c0"><meta property="twitter:card" content="summary"><meta property="twitter:site" content="@wowchemy"><meta property="twitter:creator" content="@wowchemy"><meta property="twitter:image" content="https://johnswyou.github.io/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_3.png"><meta property="og:site_name" content="John You"><meta property="og:url" content="https://johnswyou.github.io/post/dft-circular-convolution/"><meta property="og:title" content="Circular Convolution Using Discrete Fourier Transform | John You"><meta property="og:description" content="In this article, I show the mechanics of the discrete Fourier transform (DFT) and circular convolution (within the context of time series analysis). The goal of this post is to present these two methods in a practical yet non-superficial way."><meta property="og:image" content="https://johnswyou.github.io/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_3.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2023-03-01T00:00:00+00:00"><meta property="article:modified_time" content="2023-03-01T00:00:00+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://johnswyou.github.io/post/dft-circular-convolution/"},"headline":"Circular Convolution Using Discrete Fourier Transform","datePublished":"2023-03-01T00:00:00Z","dateModified":"2023-03-01T00:00:00Z","author":{"@type":"Person","name":"John You"},"publisher":{"@type":"Organization","name":"John You","logo":{"@type":"ImageObject","url":"https://johnswyou.github.io/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_3.png"}},"description":"In this article, I show the mechanics of the discrete Fourier transform (DFT) and circular convolution (within the context of time series analysis). The goal of this post is to present these two methods in a practical yet non-superficial way."}</script><title>Circular Convolution Using Discrete Fourier Transform | John You</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=b3d70adc0c9bf82121fa381ea7cf6b00><script src=/js/wowchemy-init.min.ec9d49ca50e4b80bdb08f0417a28ed84.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>John You</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>John You</a></div><div class="navbar-collapse main-menu-item collapse justify-content-center" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class="nav-link active" href=/post/><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/project/><span>Projects</span></a></li><li class=nav-item><a class=nav-link href=/authors/admin/><span>About</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></header></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>Circular Convolution Using Discrete Fourier Transform</h1><div class=article-metadata><span class=article-date>Mar 1, 2023</span>
<span class=middot-divider></span>
<span class=article-reading-time>5 min read</span></div></div><div class=article-container><div class=article-style><p>In this article, I show the mechanics of the discrete Fourier transform (DFT) and circular convolution (within the context of time series analysis). The goal of this post is to present these two methods in a practical yet non-superficial way. We will only deal with real, finite length time series
$\left\{a_t\right\}$. The primary reference for this article is &ldquo;Wavelet Methods for Time Series Analysis&rdquo; by Percival and Walden.</p><h1 id=discrete-fourier-transform-dft>Discrete Fourier Transform (DFT)</h1><p>The discrete Fourier transform takes a time series from the time domain to the frequency domain. The transform allows us to see the frequency content of a time series.</p><p>Suppose we are given a time series</p>$$
\left\{a_t\right\}=\left\{a_t: t=0, \ldots, N-1\right\}
$$<p>Its discrete Fourier transform is the complex sequence
$\left\{A_k\right\}$ given by:</p>$$
A_k \equiv \sum_{t=0}^{N-1} a_t e^{-i 2 \pi t k / N}, \quad k=0, \ldots, N-1
$$<p>Note that
$A_k$ is associated with frequency
$f_k \equiv k / N$.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>matplotlib</span> <span class=kn>import</span> <span class=n>pyplot</span> <span class=k>as</span> <span class=n>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>naive_finite_fourier_transform</span><span class=p>(</span><span class=n>a</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># a can be a list or 1D numpy array</span>
</span></span><span class=line><span class=cl>    <span class=n>N</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>A</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>N</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>A_k</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>t</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>N</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>A_k</span> <span class=o>+=</span> <span class=n>a</span><span class=p>[</span><span class=n>t</span><span class=p>]</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>((</span><span class=o>-</span><span class=mi>1</span><span class=n>j</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=n>t</span> <span class=o>*</span> <span class=n>k</span><span class=p>)</span><span class=o>/</span><span class=n>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>A</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>A_k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>A</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>asarray</span><span class=p>(</span><span class=n>A</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=o>=</span> <span class=p>[</span><span class=n>k</span><span class=o>/</span><span class=n>N</span> <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>N</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>asarray</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>A</span><span class=p>,</span> <span class=n>f</span>
</span></span></code></pre></div><p>We can reconstruct
$\left\{a_t\right\}$ from its DFT
$\left\{A_k\right\}$ using the inverse DFT:</p>$$
\frac{1}{N} \sum_{k=0}^{N-1} A_k e^{i 2 \pi t k / N}=a_t, \quad t=0, \ldots, N-1
$$<div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>naive_inverse_finite_fourier_transform</span><span class=p>(</span><span class=n>A</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># a can be a list or 1D numpy array</span>
</span></span><span class=line><span class=cl>    <span class=n>N</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>A</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>t</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>N</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>a_t</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>N</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>a_t</span> <span class=o>+=</span> <span class=n>A</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>((</span><span class=mi>1</span><span class=n>j</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=n>t</span> <span class=o>*</span> <span class=n>k</span><span class=p>)</span><span class=o>/</span><span class=n>N</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>a</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=mi>1</span><span class=o>/</span><span class=n>N</span><span class=p>)</span><span class=o>*</span><span class=n>a_t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>a</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>asarray</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=n>N</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>t</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>asarray</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>real</span><span class=p>(</span><span class=n>a</span><span class=p>),</span> <span class=n>t</span>
</span></span></code></pre></div><h2 id=example>Example</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>random</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>A</span><span class=p>,</span> <span class=n>f</span> <span class=o>=</span> <span class=n>naive_finite_fourier_transform</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=mi>1</span><span class=p>:],</span> <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>A</span><span class=p>[</span><span class=mi>1</span><span class=p>:])</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>axvline</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;red&#34;</span><span class=p>,</span> <span class=n>linestyle</span> <span class=o>=</span> <span class=s2>&#34;--&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=./index_16_0.png alt=png loading=lazy data-zoomable></div></div></figure></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>a1</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>naive_inverse_finite_fourier_transform</span><span class=p>(</span><span class=n>A</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>np</span><span class=o>.</span><span class=n>allclose</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>a1</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>True
</code></pre><h1 id=circular-convolutionfiltering>Circular Convolution/Filtering</h1><p>Circular convolution (also called circular filtering) is a simple idea, but is cumbersome to read when described with math. For this reason, I will first show how circular convolution works using pictures before presenting any mathematics.</p><p>Suppose we have two time series,
$\{a_t\}$ and
$\{b_t\}$, both of length
$N=10$. I won&rsquo;t specify the value of the time series here (I&rsquo;ll leave them to the reader&rsquo;s imagination). I will only show the time indices of each time series in the pictures below. The indices of the first time series
$\{a_t\}$ will be shown in red as follows:</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt="Time series" srcset="/post/dft-circular-convolution/a_t_huafdc7c7ab93997ae1a4e20ede4b07927_4666_1671a7272d04d0bf9620079519be735b.webp 400w,
/post/dft-circular-convolution/a_t_huafdc7c7ab93997ae1a4e20ede4b07927_4666_d258da55313950bbfc0fb6282a8e42c7.webp 760w,
/post/dft-circular-convolution/a_t_huafdc7c7ab93997ae1a4e20ede4b07927_4666_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/post/dft-circular-convolution/a_t_huafdc7c7ab93997ae1a4e20ede4b07927_4666_1671a7272d04d0bf9620079519be735b.webp width=760 height=43 loading=lazy data-zoomable></div></div></figure></p><p>and the indices of the second series
$\{b_t\}$ will be shown in black to distinguish it from
$\{a_t\}$:</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/post/dft-circular-convolution/b_t_hu93b073cd32fb94c04684d0d212fa894d_9013_7d37d3ffbd030ee838905804105a78a5.webp 400w,
/post/dft-circular-convolution/b_t_hu93b073cd32fb94c04684d0d212fa894d_9013_6b41820a635341623bc1d38017007dda.webp 760w,
/post/dft-circular-convolution/b_t_hu93b073cd32fb94c04684d0d212fa894d_9013_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/post/dft-circular-convolution/b_t_hu93b073cd32fb94c04684d0d212fa894d_9013_7d37d3ffbd030ee838905804105a78a5.webp width=760 height=47 loading=lazy data-zoomable></div></div></figure></p><p>The first step is to reverse the order of
$\{a_t\}$, which makes its indices look as follows:</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt="Time series reversed" srcset="/post/dft-circular-convolution/a_t_reversed_hu8f93d865b1f68e953f41d6b95fb517eb_8425_04c924f244c745303c1c84cbc9638cb2.webp 400w,
/post/dft-circular-convolution/a_t_reversed_hu8f93d865b1f68e953f41d6b95fb517eb_8425_d50e225d9fd5d0bebff546115641032c.webp 760w,
/post/dft-circular-convolution/a_t_reversed_hu8f93d865b1f68e953f41d6b95fb517eb_8425_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/post/dft-circular-convolution/a_t_reversed_hu8f93d865b1f68e953f41d6b95fb517eb_8425_04c924f244c745303c1c84cbc9638cb2.webp width=760 height=49 loading=lazy data-zoomable></div></div></figure></p><p>Next, we concatenate
$\{b_t\}$ front to back and perform a sequence of sliding dot products between
$\{a_t\}$ and the newly lengthened version of
$\{b_t\}$ as follows:</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/post/dft-circular-convolution/conv1_hu248a934e8d12d70c9b4cd1469dacd4a6_45305_62f3d7cbd45952d56852ccbe8990bd4e.webp 400w,
/post/dft-circular-convolution/conv1_hu248a934e8d12d70c9b4cd1469dacd4a6_45305_8999dea5f82620015be077c99e3f98dc.webp 760w,
/post/dft-circular-convolution/conv1_hu248a934e8d12d70c9b4cd1469dacd4a6_45305_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/post/dft-circular-convolution/conv1_hu248a934e8d12d70c9b4cd1469dacd4a6_45305_62f3d7cbd45952d56852ccbe8990bd4e.webp width=760 height=234 loading=lazy data-zoomable></div></div></figure></p><p>The above picture shows how the first element of the result of a circular convolution between
$\{a_t\}$ and
$\{b_t\}$ is constructed:</p><p>The next element can be constructed as follows:</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/post/dft-circular-convolution/conv2_hu74bfa12dc7368ee99160ed8410294e11_47358_2c8361e8511f3146f7ae7e2a7aa2b917.webp 400w,
/post/dft-circular-convolution/conv2_hu74bfa12dc7368ee99160ed8410294e11_47358_12b98abe1f198549ddee4fa8986bc349.webp 760w,
/post/dft-circular-convolution/conv2_hu74bfa12dc7368ee99160ed8410294e11_47358_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/post/dft-circular-convolution/conv2_hu74bfa12dc7368ee99160ed8410294e11_47358_2c8361e8511f3146f7ae7e2a7aa2b917.webp width=760 height=240 loading=lazy data-zoomable></div></div></figure></p><p>and here&rsquo;s element
$N-2$ of the resultant circular convolution time series:</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img alt srcset="/post/dft-circular-convolution/conv3_huf330c55d803386c09fdd55f7d7650179_52323_28e393fd22bda124c0c5d08d312523bc.webp 400w,
/post/dft-circular-convolution/conv3_huf330c55d803386c09fdd55f7d7650179_52323_c01c75dd29a083c45adcea49761f9073.webp 760w,
/post/dft-circular-convolution/conv3_huf330c55d803386c09fdd55f7d7650179_52323_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/post/dft-circular-convolution/conv3_huf330c55d803386c09fdd55f7d7650179_52323_28e393fd22bda124c0c5d08d312523bc.webp width=760 height=230 loading=lazy data-zoomable></div></div></figure></p><p>In general, the result of a convolution between two time series (both of length
$N$) is a resultant time series also of length
$N$.</p><p>Mathematically, the
$t^{th}$ element of the resultant time series from a circular convolution between two time series
$\{a_t\}$ and
$\{b_t\}$ (both of length
$N$) is:</p>$$
a * b_t \equiv \sum_{u=0}^{N-1} a_u b_{t-u}
$$<p>where
$t = 0, 1, \dots, N-1$.</p><p>Whenever the subscript on
$b$ is negative (which occurs whenever
$u$ is greater than
$t$), we define
$b_{-1}=b_{N-1} ; b_{-2}=b_{N-2}$ and so on.</p><p>More compactly (at the expense of readability), we can also write the
$t^{th}$ element of the resultant time series of a circular convolution between two time series
$\{a_t\}$ and
$\{b_t\}$ as:</p>$$
a * b_t \equiv \sum_{u=0}^{N-1} a_u b_{(t-u) \bmod N}, \quad t=0, \ldots, N-1
$$<p>where
$\bmod$ is the modulo operator.</p><p>Here&rsquo;s a coded implementation:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>naive_circular_convolution</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>a</span><span class=p>)</span> <span class=o>==</span> <span class=nb>len</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>N</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>t</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>N</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>c_t</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>u</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>N</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>c_t</span> <span class=o>+=</span> <span class=n>a</span><span class=p>[</span><span class=n>u</span><span class=p>]</span><span class=o>*</span><span class=n>b</span><span class=p>[(</span><span class=n>t</span><span class=o>-</span><span class=n>u</span><span class=p>)</span> <span class=o>%</span> <span class=n>N</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>c</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>c_t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>asarray</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=circular-convolution-using-dft>Circular Convolution Using DFT</h2><p>A key fact is that a circular convolution can be computed using the DFT and inverse DFT. Here&rsquo;s how:</p><ol><li>Compute the DFT of
$\{a_t\}$, denoted by
$\{A_k\}$</li><li>Compute the DFT of
$\{b_t\}$, denoted by
$\{B_k\}$</li><li>Take the inverse DFT of
$\{A_{k} B_{k}\}$</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>naive_circular_convolution_dft</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>A</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>naive_finite_fourier_transform</span><span class=p>(</span><span class=n>a</span><span class=p>)</span> <span class=c1># STEP 1</span>
</span></span><span class=line><span class=cl>    <span class=n>B</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>naive_finite_fourier_transform</span><span class=p>(</span><span class=n>b</span><span class=p>)</span> <span class=c1># STEP 2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># STEP 3</span>
</span></span><span class=line><span class=cl>    <span class=n>C</span> <span class=o>=</span> <span class=n>A</span><span class=o>*</span><span class=n>B</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>naive_inverse_finite_fourier_transform</span><span class=p>(</span><span class=n>C</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>c</span>
</span></span></code></pre></div><h2 id=example-1>Example</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>random</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>b</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>random</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=n>naive_circular_convolution</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>c1</span> <span class=o>=</span> <span class=n>naive_circular_convolution_dft</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>np</span><span class=o>.</span><span class=n>allclose</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>c1</span><span class=p>)</span>
</span></span></code></pre></div><pre><code>True
</code></pre><h1 id=final-words>Final Words</h1><p>An interesting point to mention is that circular convolution can be performed using a filter
$\{a_t\}$ that is infinite in length (while the time series
$\{b_t\}$ is finite in length). This is made possible by a process known as &ldquo;filter periodization&rdquo;. I will make a post in the future about this interesting topic.</p><p>Thanks for reading!</p></div><div class=share-box><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fjohnswyou.github.io%2Fpost%2Fdft-circular-convolution%2F&amp;text=Circular+Convolution+Using+Discrete+Fourier+Transform" target=_blank rel=noopener class=share-btn-twitter aria-label=twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fjohnswyou.github.io%2Fpost%2Fdft-circular-convolution%2F&amp;t=Circular+Convolution+Using+Discrete+Fourier+Transform" target=_blank rel=noopener class=share-btn-facebook aria-label=facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=Circular%20Convolution%20Using%20Discrete%20Fourier%20Transform&amp;body=https%3A%2F%2Fjohnswyou.github.io%2Fpost%2Fdft-circular-convolution%2F" target=_blank rel=noopener class=share-btn-email aria-label=envelope><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fjohnswyou.github.io%2Fpost%2Fdft-circular-convolution%2F&amp;title=Circular+Convolution+Using+Discrete+Fourier+Transform" target=_blank rel=noopener class=share-btn-linkedin aria-label=linkedin-in><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=Circular+Convolution+Using+Discrete+Fourier+Transform%20https%3A%2F%2Fjohnswyou.github.io%2Fpost%2Fdft-circular-convolution%2F" target=_blank rel=noopener class=share-btn-whatsapp aria-label=whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Fjohnswyou.github.io%2Fpost%2Fdft-circular-convolution%2F&amp;title=Circular+Convolution+Using+Discrete+Fourier+Transform" target=_blank rel=noopener class=share-btn-weibo aria-label=weibo><i class="fab fa-weibo"></i></a></li></ul></div><div class="media author-card content-widget-hr"><a href=https://johnswyou.github.io/><img class="avatar mr-3 avatar-circle" src=/authors/admin/avatar_hu5e0566872520e525a56cb71618c15373_14540_270x270_fill_q75_lanczos_center.jpg alt="John You"></a><div class=media-body><h5 class=card-title><a href=https://johnswyou.github.io/>John You</a></h5><h6 class=card-subtitle>MASc Candidate, Civil Engineering</h6><ul class=network-icon aria-hidden=true><li><a href=mailto:jswyou@uwaterloo.ca><i class="fas fa-envelope"></i></a></li><li><a href=https://github.com/johnswyou target=_blank rel=noopener><i class="fab fa-github"></i></a></li><li><a href=https://www.linkedin.com/in/johnyou target=_blank rel=noopener><i class="fab fa-linkedin"></i></a></li><li><a href=/uploads/resume.pdf><i class="ai ai-cv"></i></a></li></ul></div></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class="powered-by copyright-license-text">© 2023 John You.</p><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> — the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script>
<script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js type=module></script>
<script src=/en/js/wowchemy.min.e8ee06ba8371980ffde659871dd593b0.js></script></body></html>